/*
 *  Copyright (C) 2017 DYNA Instruments GmbH,
 *                2017 Johannes Lode <linuxer@quantentunnel.de>
 *
 * DT-Overlay f√ºr PWM-Tests mit PCA9685 und einigen LEDs
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 */
/dts-v1/;
/plugin/;

/ {
	compatible = "dyna,dyncacon", "guf,eco-g45", "atmel,at91sam9g45", "atmel,at91sam9";

        /* identification */
        part-number = "DYNAconII-I2C-pwm-test";
        version = "0100";
 
        /* state the resources this overlay uses */
        exclusive-use ="PB20", "PB21";
 
	fragment@0 {
		i2c-gpio-2 {
			compatible = "i2c-gpio";
			// status = "disabled";

			gpios = <&pioB 21 0 // sda, DISP-D6, PB21
				 &pioB 20 0 // scl, DISP-D7, PB20
				>;
			// i2c-gpio,sda-open-drain;	// nicht einschalten, hat im Test nicht funktioniert
			// i2c-gpio,scl-open-drain;	// nicht einschalten, hat im Test nicht funktioniert
			i2c-gpio,delay-us = <3>;	// ~100 kHz
			#address-cells = <1>;
			#size-cells = <0>;
		
			pwm16_1: pca9685@40 {
				compatible = "nxp,pca9685-pwm";
				status = "disabled";
				#pwm-cells = <2>;
				reg = <0x40>;
			//	invert;
			//	open-drain;
			};
		};
		pwmleds1 {
			compatible = "pwm-leds";
			// status = "disabled";

			pwmled0 {
				label = "dyna-test::disk";
				pwms = <&pwm16_1 0 700000>;
				max-brightness = <255>;
				linux,default-trigger = "nand-disk";
			};

			pwmled1 {
				label = "dyna-test::lan-rx";
				pwms = <&pwm16_1 1 700000>;
				max-brightness = <255>;
				linux,default-trigger = "netdev";
			};

			pwmled2 {
				label = "dyna-test::lan-tx";
				pwms = <&pwm16_1 2 700000>;
				max-brightness = <255>;
				linux,default-trigger = "netdev";
			};

			pwmled3 {
				label = "dyna-test::can-rx";
				pwms = <&pwm16_1 3 700000>;
				max-brightness = <255>;
				linux,default-trigger = "netdev";
			};

			pwmled4 {
				label = "dyna-test::can-tx";
				pwms = <&pwm16_1 4 700000>;
				max-brightness = <255>;
				linux,default-trigger = "netdev";
			};

			pwmled5 {
				label = "dynatest::heartbeat";
				pwms = <&pwm16_1 5 700000>;
				max-brightness = <255>;
				linux,default-trigger = "heartbeat";
			};

			pwmled6 {
				label = "dynatest::cpu0";
				pwms = <&pwm16_1 5 700000>;
				max-brightness = <255>;
				linux,default-trigger = "cpu0";
			};
		};
        };
};

